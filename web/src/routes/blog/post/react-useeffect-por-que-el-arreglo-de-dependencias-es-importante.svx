---
date: 2020-11-02T09:17:52-03:00
banner: https://res.cloudinary.com/matiasfha/image/upload/v1604323837/monirul-islam-shakil-31I2Mi1UuxQ-unsplash_kkerl8.jpg
keywords:
- React
- hooks
- useEffect
tag: Seed
featured: true
title: React useEffect ¬øPor que el arreglo de dependencias es importante?
description: React `useEffect` es quiz√° el hook que m√°s confusiones genera a la hora
  de utilizarlo. Una confusi√≥n com√∫n es el uso del arreglo de dependencias
bannerCredit: <span>Photo by <a href="https://unsplash.com/@themisphotography?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Monirul
  Islam Shakil</a> on <a href="https://unsplash.com/s/photos/effect?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></span>

---
React `useEffect` es quiz√° el hook que m√°s confusiones genera a la hora de utilizarlo.
Algunas de esas confusiones se debe al intento de comparar su funcionamiento con los estados del ciclo de vida de un componente de clase, algo que aclaro en [este post anterior](https://matiashernandez.dev/react-useeffect-hook-comparado-con-los-estados-del-ciclo-de-vida)

> Recomendado:
>
> [¬øQu√© son los hooks?](https://matiashernandez.dev/blog/post/que-son-los-hooks)
>
> [Algunos errores comunes al utilizar React hooks.](https://matiashernandez.dev/blog/post/algunos-errores-comunes-al-utilizar-react-hooks)

El hook useEffect recibe dos argumentos, una funcion/callback que define el efecto deseado y un listado/arreglo de valores que definen las dependencias del efecto.
Estas dependencias le sirven a React para saber cu√°ndo o m√°s bien **por qu√©** el efecto debe ejecutarse.

Internamente useEffect "observa" este listado de dependencias y cuando uno de los valores de ellas cambia el efecto es emitido. Esto te permite optimizar la ejecuci√≥n del efecto.

> Mant√©n en mente que React realiza una comparaci√≥n utilizando [Object.is](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is) para determinar si hubo un cambio en uno de los elementos. Si necesitas hacer una comparaci√≥n "profunda" puedes utilizar este hook [useDeepCompareEffect](https://github.com/kentcdodds/use-deep-compare-effect)

El equipo de React provee un[ plugin de eslint ](https://www.npmjs.com/package/eslint-plugin-react-hooks)que ayuda a identificar cuando hay dependencias no identificadas por medio de la regla: [**react-hooks/exhaustive-deps**](https://es.reactjs.org/docs/hooks-rules.html#eslint-plugin)

En general un efecto es una funci√≥n que ejecuta cierta l√≥gica para sincronizar el estado interno del componente con un estado externo (si, no me canso de repetirlo ü§∑‚Äç‚ôÇÔ∏è).

```javascript
useEffect(() => {
    	fetch("/api/data").then(
    		res => setState(res.data)
    	)
    }, [setState])
```

### Y por que las dependencias son importantes?

Simple! Por que las dependencias son la forma de controlar cuando el efecto se ejecuta o no. Recuerda. No se trata de si el efecto ocurre al montar el componente (o cualquier otro "momento"), si no, de por qu√© se ejecuta (cambio en un valor de una dependencia?

### Y ¬øpor qu√© debo escribir todas las dependencias del efecto?

Si tu efecto utiliza un valor dentro de su l√≥gica pero no lo declaras como dependencia entonces "algo huele mal"(code smell)

El plugin de eslint reportar√° la dependencia faltante como un warning. Entonces ¬øPor qu√© es tan importante si s√≥lo se reporta como un warning?.

Bueno, es un bug que en cualquier momento volver√° a morderte.

Tu efecto funciona incluso sin declarar la dependencia por que la funci√≥n/callback definida funciona como un closure y es capaz de utilizar el valor externo a su scope.

Si miramos el mismo ejemplo anterior, podemos escribirlo sin dependencias o con una lista vac√≠a (lo que indica que se ejecutar√° s√≥lo una vez)

```javascript
useEffect(() => {
    	fetch("/api/data").then(
    		res => setState(res.data)
    	)
    }, [])
```

Pero, pi√©nsalo as√≠, estas declarando una funci√≥n que trabaja con ciertos valores pero no le estas dando acceso directo a esos valores!! No es extra√±o?
¬øEst√°s diciendo que tu funci√≥n usa un valor pero que no depende de √©l?

# ¬øEntonces que hacer?
Hay que redefinir la l√≥gica de tu efecto para que solo utilice los valores de los que realmente dependa.

¬øC√≥mo? Una forma es extraer la l√≥gica hacia una funci√≥n externa y utilizar esta nueva funci√≥n como dependencia del efecto.


Te dejo algunos muy buenos art√≠culos sobre useEffect:
* Kent C Dodds: Escrbi√≥ [un articulo](https://kentcdodds.com/blog/react-hooks-pitfalls) sobre algunos errores al utilizar hooks, en donde comenta sobre el no uso de las dependencias.

* [Dan Abramov](https://twitter.com/dan_abramov) tiene un art√≠culo en [profundidad sobre useEffect](http://overreacted.io/a-complete-guide-to-useeffect/)

* [Y este √°rt√≠culo](https://daveceddia.com/useeffect-hook-examples/) de Dave Ceddia

Mantente atento sobre estos temas y m√°s uniendote a mi newsletter!
Pronto noticias sobre el curso sobre React en el que estoy trabajando para a [@eggheadio](http://egghead.io/instructors/matias-francisco-hernandez-arellano)
